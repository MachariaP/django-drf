# render.yaml
services:
  # Django Web Service
  - type: web
    name: django-api
    env: docker
    dockerfilePath: ./Dockerfile
    repo: https://github.com/yourusername/your-repo.git  # Replace with your GitHub
    branch: main
    plan: free
    envVars:
      - key: DEBUG
        value: "False"
      - key: SECRET_KEY
        value: "your-super-secret-key-here"  # Generate one: python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"
      - key: DJANGO_SUPERUSER_USERNAME
        value: "admin"
      - key: DJANGO_SUPERUSER_PASSWORD
        value: "SuperSecret123!"
      - key: DJANGO_ENV
        value: "production"
    healthCheckPath: /api/health/  # Add a health view if needed
    autoDeploy: true

  # Postgres Database
  - type: pgsql
    name: django-db
    databaseName: django_drf_db
    region: oregon  # or closest to you
    plan: free
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: django-db
          property: connectionString

  # Redis (use external for free tier; Render doesn't have native free Redis)
  # Note: Set REDIS_URL manually after creating Upstash (free Redis-as-a-service)
  # Upstash: upstash.com → Free Redis → Copy connection string to envVars below

# Build & Start Commands (in Dockerfile/entrypoint)
# Your existing Dockerfile already handles: build, migrate, collectstatic, seed, gunicorn
